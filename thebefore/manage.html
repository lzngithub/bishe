<html>
    <head>
        <meta charset="utf-8">  
        <link rel="stylesheet" type="text/css" href="adminMain.css">
        <link rel="stylesheet" type="text/css" href="upload.css">
        <title>迎新系统</title>
    </head>
    <body>
        <div class="wrapper">
            <div class="content1">
                    <div>
                            <span></span>
                        </div>
                        <!-- <div>武汉理工大学</div> -->
                        <!-- <div>|</div> -->
                        <div>迎新系统（管理员界面）</div>
    

                    <div class="top2">
                        <div>
                            <img src="source/pic/头像.jpg" alt="">
                        </div>
                        <div>
                            校级管理员
                        </div>
                        <div>
                            <button class="cancle">注销</button>
                        </div>
                    </div>


            </div>
            <div class="content2">

            </div>
            <div class="content3">
                <div class="main-box">
                    <div class="main-left">
                            <ul>
                                <li><a href="http://localhost/whutNSS/thebefore/upload.html?yeshu=0">新生基本信息管理</a></li>
                                <li><a href="http://localhost/whutNSS/thebefore/class.html">班级分配管理</a></li>
                                <li><a href="http://localhost/whutNSS/thebefore/checkclass.html">专业分配情况查询</a></li>
                                <li><a href="http://localhost/whutNSS/thebefore/manage.html">系统管理</a></li>
                            </ul>

                    </div>
                    <div class="main-right">
                        <div>
                            <span class="mana">数据备份</span>
                            <span class="mana">设置院系参数</span>
                            <span class="mana">管理用户</span>
                        </div>
                        <div class='tb'>
                            
                        </div>
                        <div class="tb1" style="display:none">
                            <button class="add">添加</button>
                            <form action="http://localhost/whutNSS/theafter/add1.php" method="POST" style="display:none" class="form9">
                                专业代码：<input type="text" value="" name="SdepID">
                                学院：<input type="text" value="" name="Sdepartment">
                                专业：<input type="text" value="" name="Smajor">
                                <input type="submit" value="添加">
                            </form>
                        </div>
                        <div class="tb2" style="display:none">
                            <button class="add2">添加</button>
                            <form action="http://localhost/whutNSS/theafter/add3.php" method="POST" style="display:none" class="form8">
                                用户名：<input type="text" value="" name="user">
                                密码：<input type="text" value="" name="password">
                                权限代号：<input type="text" value="" name="per">
                                <input type="submit" value="添加">
                            </form>
                        </div>

                    </div>

                </div>

            </div>
        </div>
        <script type="text/javascript" src="cancel.js"></script>
        <script type="text/javascript">
            var mana = document.getElementsByClassName('mana');
            mana[0].onclick = function(){
                window.open('http://localhost/whutNSS/theafter/copydata.php');
            }
            
            mana[1].onclick = function (){
                document.getElementsByClassName('add')[0].style.display='inline';
                document.getElementsByClassName('add2')[0].style.display='none';
                document.getElementsByClassName('tb2')[0].style.display='none';
                document.getElementsByClassName('tb1')[0].style.display='inline';
                document.getElementsByClassName('form9')[0].style.display='none';
                document.getElementsByClassName('form8')[0].style.display='none';
                
                var xmlHttp;  
                try { 
                    // Firefox, Opera 8.0+, Safari 
                    xmlHttp = new XMLHttpRequest(); 
                } 
                catch (e) { 
                    // Internet Explorer 
                    try { 
                        xmlHttp = new ActiveXObject("Msxml2.XMLHTTP"); 
                    } 
                    catch (e) { 

                        try { 
                            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP"); 
                        } 
                        catch (e) { 
                            alert("您的浏览器不支持AJAX！"); 
                        return false; 
                        } 
                    } 
                } 

                xmlHttp.onreadystatechange = function() { 
                // xmlhttp.readyState的值及解释：
                // 0：请求未初始化（还没有调用 open()）。
                // 1：请求已经建立，但是还没有发送（还没有调用 send()）。
                // 2：请求已发送，正在处理中（通常现在可以从响应中获取内容头）。
                // 3：请求在处理中；通常响应中已有部分数据可用了，但是服务器还没有完成响应的生成。
                // 4：响应已完成；您可以获取并使用服务器的响应了。
                    if (xmlHttp.readyState == 4) { 
                        //alert(xmlHttp.responseText); 
                        var str = xmlHttp.responseText; 
                        //document.getElementById('tb1').innerHTML +=str; 
                        //alert(str); 
                        console.log(str);
                        var obj = eval('('+ str +')'); 
                        var arr = Object.keys(obj);
                        var len = arr.length;
                        console.log(len);//结果为2
                        // var obj1 = JSON.parse(obj);
                        
                        rows=len;
                        cols=8;

                        console.log(arr);
                        console.log(obj);
                        console.log(obj[0].Sno);

                        var tab='<table class="tb1">'
                            tab+='<thead>'
                                tab+='<tr>'
                                    tab+="<th>"+'专业代号'+"</th>"
                                    tab+="<th>"+'学院'+"</th>"
                                    tab+="<th>"+'专业'+"</th>"
                                    tab+="<th>"+'操作'+"</th>"
                                tab+="</tr>"
                            tab+="</thead>"
                            for(var i=0;i<rows;i++){
                                tab+='<tr>'
                                    tab+="<td>"+obj[i].SdepID+"</td>"
                                    tab+="<td>"+obj[i].Sdepartment+"</td>"
                                    tab+="<td>"+obj[i].Smajor+"</td>"
                                    tab+="<td>"+"<a href='http://localhost/whutNSS/theafter/del1.php?SdepID="+obj[i].SdepID+"' onclick='return confirmAct()'>"+"删除"+"</a>"+"&nbsp"
                                            +"<a href='http://localhost/whutNSS/thebefore/update1.html?SdepID="+obj[i].SdepID+"&Sdepartment="+obj[i].Sdepartment
                                            +"&Smajor="+obj[i].Smajor+"'>"+"修改"+"</a>"
                                            +"</td>"
                                tab+='</tr>'                           
                            }
                        tab+='</table>'
                        document.getElementsByClassName('tb')[0].innerHTML=tab;
                    }
                } 
                xmlHttp.open("POST", "http://localhost/whutNSS/theafter/manage2.php", true); 
                xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); 
                xmlHttp.send(null); 
            }
            var add = document.getElementsByClassName('add')[0];
            add.onclick = function(){
                document.getElementsByClassName('form9')[0].style.display = 'inline';
            }
            var add2 = document.getElementsByClassName('add2')[0];
            add2.onclick = function(){
                document.getElementsByClassName('form8')[0].style.display = 'inline';
            }
            mana[2].onclick = function(){ 
//                document.getElementsByClassName('add1')[0].style.display='none';
                document.getElementsByClassName('add')[0].style.display='none';
                document.getElementsByClassName('add2')[0].style.display='inline';
                document.getElementsByClassName('tb2')[0].style.display='inline';
                document.getElementsByClassName('form9')[0].style.display='none';
                document.getElementsByClassName('form8')[0].style.display='none';
                
                var xmlHttp;  
                try { 
                    // Firefox, Opera 8.0+, Safari 
                    xmlHttp = new XMLHttpRequest(); 
                } 
                catch (e) { 
                    // Internet Explorer 
                    try { 
                        xmlHttp = new ActiveXObject("Msxml2.XMLHTTP"); 
                    } 
                    catch (e) { 

                        try { 
                            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP"); 
                        } 
                        catch (e) { 
                            alert("您的浏览器不支持AJAX！"); 
                        return false; 
                        } 
                    } 
                } 

                xmlHttp.onreadystatechange = function() { 
                // xmlhttp.readyState的值及解释：
                // 0：请求未初始化（还没有调用 open()）。
                // 1：请求已经建立，但是还没有发送（还没有调用 send()）。
                // 2：请求已发送，正在处理中（通常现在可以从响应中获取内容头）。
                // 3：请求在处理中；通常响应中已有部分数据可用了，但是服务器还没有完成响应的生成。
                // 4：响应已完成；您可以获取并使用服务器的响应了。
                    if (xmlHttp.readyState == 4) { 
                        //alert(xmlHttp.responseText); 
                        var str = xmlHttp.responseText; 
                        //document.getElementById('tb1').innerHTML +=str; 
                        //alert(str); 
                        console.log(str);
                        var obj = eval('('+ str +')'); 
                        var arr = Object.keys(obj);
                        var len = arr.length;
                        console.log(len);//结果为2
                        // var obj1 = JSON.parse(obj);
                        
                        rows=len;
                        cols=8;

                        console.log(arr);
                        console.log(obj);
                        console.log(obj[0].Sno);

                        var tab='<table class="tb1">'
                            tab+='<thead>'
                                tab+='<tr>'
                                    tab+="<th>"+'用户名'+"</th>"
                                    tab+="<th>"+'密码'+"</th>"
                                    tab+="<th>"+'权限代号'+"</th>"
                                    tab+="<th>"+'操作'+"</th>"
                                tab+="</tr>"
                            tab+="</thead>"
                            for(var i=0;i<rows;i++){
                                tab+='<tr>'
                                    tab+="<td>"+obj[i].user+"</td>"
                                    tab+="<td>"+obj[i].password+"</td>"
                                    tab+="<td>"+obj[i].per+"</td>"
                                    tab+="<td>"+"<a href='http://localhost/whutNSS/theafter/del3.php?user="+obj[i].user+"' onclick='return confirmAct()'>"+"删除"+"</a>"+"&nbsp"
                                            +"<a href='http://localhost/whutNSS/thebefore/update3.html?id="+obj[i].id+"&user="+obj[i].user+"&password="+obj[i].password
                                            +"&per="+obj[i].per+"'>"+"修改"+"</a>"
                                            +"</td>"
                                tab+='</tr>'                           
                            }
                        tab+='</table>'
                        document.getElementsByClassName('tb')[0].innerHTML=tab;
                    }
                } 
                xmlHttp.open("POST", "http://localhost/whutNSS/theafter/manage3.php", true); 
                xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); 
                xmlHttp.send(null); 
            }
            function confirmAct() 
            { 
              if(confirm('确定要执行此操作吗?')) 
              { 
                return true; 
              } 
              return false; 
            }


        </script>

    </body>
	
</html>